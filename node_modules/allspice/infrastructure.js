var futureExports = {};

var path = require('path');
function getRequire(dirname) {
  return function (mod) {
    if (/\//.test(mod)) {
      var desired = stripJsExt(path.resolve(dirname, mod)),
        isLocal = combinedModules.some(function (combined) {
          return stripJsExt(combined) === desired;
        });

      if (isLocal) {
        var moduleName = getModule(desired);
        var module = loadModule(moduleName);
        if (module) {
          return module;
        }
      }
    }
    return require(mod);
  }
}

function getModule(filepath) {
  var file = path.basename(filepath);
  return stripJsExt(file);
}

function stripJsExt(filepath) {
  return filepath.replace(/\.js$/, '');
}

function loadModules() {
  Object.keys(futureExports).forEach(loadModule);
}

function loadModule(mod) {
  var module = exports[mod];
  if (!module) {
    module = exports[mod] = futureExports[mod]();
  }
  return module;
}
